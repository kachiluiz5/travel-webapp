<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Itinerary</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #64748b;
            --success-color: #22c55e;
            --background-color: #f8fafc;
            --card-background: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.5;
            padding: 2rem;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .trip-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-success { background-color: var(--success-color); color: white; }
        .btn-danger { background-color: #ef4444; color: white; }

        .card {
            background-color: var(--card-background);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .budget-overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .activities-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: var(--background-color);
            border-radius: 0.5rem;
            cursor: move;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 500px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 1rem; }
            .budget-overview { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1 class="trip-title">Chennai to Ooty Trip</h1>
                <p id="trip-dates"></p>
            </div>
            <div>
                <button class="btn btn-success" onclick="openModal()">
                    <i class="fas fa-plus"></i> Add Activity
                </button>
            </div>
        </div>

        <div class="card">
            <h2><i class="fas fa-dollar-sign"></i> Budget Overview</h2>
            <div class="budget-overview">
                <div>
                    <h3>Total Budget</h3>
                    <div id="total-budget">$1,000</div>
                </div>
                <div>
                    <h3>Spent</h3>
                    <div id="total-spent">$0</div>
                </div>
                <div>
                    <h3>Remaining</h3>
                    <div id="remaining-budget">$1,000</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2><i class="fas fa-calendar"></i> Activities</h2>
            <div id="activities-list" class="activities-list"></div>
        </div>
    </div>

    <!-- Add/Edit Activity Modal -->
    <div id="activity-modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">Add New Activity</h2>
            <form id="activity-form">
                <input type="hidden" id="activity-id">
                <div class="form-group">
                    <label for="activity-title">Activity Title</label>
                    <input type="text" id="activity-title" required>
                </div>
                <div class="form-group">
                    <label for="activity-time">Time</label>
                    <input type="time" id="activity-time" required>
                </div>
                <div class="form-group">
                    <label for="activity-description">Description</label>
                    <textarea id="activity-description" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="activity-cost">Cost ($)</label>
                    <input type="number" id="activity-cost" required min="0">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-danger" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn btn-success">Save Activity</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initialize state
        let activities = [];
        const TOTAL_BUDGET = 1000;

        // Set trip dates
        const startDate = new Date('2023-04-18');
        const endDate = new Date('2023-04-21');
        document.getElementById('trip-dates').textContent = 
            `${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}`;

        // Activity Management
        function createActivity(activity) {
            const div = document.createElement('div');
            div.className = 'activity-item';
            div.draggable = true;
            div.innerHTML = `
                <input type="checkbox" ${activity.completed ? 'checked' : ''} 
                    onchange="toggleActivity(${activity.id})">
                <div style="flex: 1">
                    <div style="color: var(--text-secondary)">
                        <i class="fas fa-clock"></i> ${activity.time}
                    </div>
                    <h3>${activity.title}</h3>
                    <p style="color: var(--text-secondary)">${activity.description}</p>
                </div>
                <div style="text-align: right">
                    <div style="font-weight: bold">$${activity.cost}</div>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem">
                        <button class="btn" onclick="editActivity(${activity.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger" onclick="deleteActivity(${activity.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            return div;
        }

        function renderActivities() {
            const container = document.getElementById('activities-list');
            container.innerHTML = '';
            activities.forEach(activity => {
                container.appendChild(createActivity(activity));
            });
            updateBudget();
        }

        function updateBudget() {
            const spent = activities.reduce((sum, activity) => sum + activity.cost, 0);
            const remaining = TOTAL_BUDGET - spent;
            
            document.getElementById('total-spent').textContent = `$${spent}`;
            document.getElementById('remaining-budget').textContent = `$${remaining}`;
        }

        // Modal Management
        const modal = document.getElementById('activity-modal');
        const form = document.getElementById('activity-form');

        function openModal(activity = null) {
            document.getElementById('modal-title').textContent = 
                activity ? 'Edit Activity' : 'Add New Activity';
            
            if (activity) {
                document.getElementById('activity-id').value = activity.id;
                document.getElementById('activity-title').value = activity.title;
                document.getElementById('activity-time').value = activity.time;
                document.getElementById('activity-description').value = activity.description;
                document.getElementById('activity-cost').value = activity.cost;
            } else {
                form.reset();
                document.getElementById('activity-id').value = '';
            }
            
            modal.classList.add('active');
        }

        function closeModal() {
            modal.classList.remove('active');
            form.reset();
        }

        // Form Submission
        form.onsubmit = function(e) {
            e.preventDefault();
            
            const activityData = {
                id: document.getElementById('activity-id').value || Date.now(),
                title: document.getElementById('activity-title').value,
                time: document.getElementById('activity-time').value,
                description: document.getElementById('activity-description').value,
                cost: Number(document.getElementById('activity-cost').value),
                completed: false
            };

            if (document.getElementById('activity-id').value) {
                // Edit existing activity
                activities = activities.map(activity => 
                    activity.id == activityData.id ? activityData : activity
                );
            } else {
                // Add new activity
                activities.push(activityData);
            }

            renderActivities();
            closeModal();
        };

        // Activity Operations
        function toggleActivity(id) {
            activities = activities.map(activity => 
                activity.id == id 
                    ? {...activity, completed: !activity.completed}
                    : activity
            );
            renderActivities();
        }

        function editActivity(id) {
            const activity = activities.find(a => a.id == id);
            if (activity) {
                openModal(activity);
            }
        }

        function deleteActivity(id) {
            if (confirm('Are you sure you want to delete this activity?')) {
                activities = activities.filter(activity => activity.id != id);
                renderActivities();
            }
        }

        // Drag and Drop
        let draggedItem = null;

        document.addEventListener('dragstart', function(e) {
            if (e.target.classList.contains('activity-item')) {
                draggedItem = e.target;
                setTimeout(() => e.target.style.opacity = '0.5', 0);
            }
        });

        document.addEventListener('dragend', function(e) {
            if (e.target.classList.contains('activity-item')) {
                e.target.style.opacity = '1';
                draggedItem = null;
            }
        });

        document.getElementById('activities-list').addEventListener('dragover', function(e) {
            e.preventDefault();
            const afterElement = getDragAfterElement(this, e.clientY);
            if (draggedItem) {
                if (afterElement) {
                    this.insertBefore(draggedItem, afterElement);
                } else {
                    this.appendChild(draggedItem);
                }
            }
        });

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.activity-item:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Initial render
        renderActivities();
    </script>
</body>
</html>